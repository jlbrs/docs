---
title: 'Webhook Events'
icon: 'webhook'
---

When an event occurs in the system which a Webhook is subscribed to, we create a Webhook Event object containing data around the event that happened. We then:

1. Send the event to your Webhook endpoint
2. Capture a trace of the event so you can later check all Webhook Events sent to your webhooks (through [List Webhook Events](/api-reference/webhooks/list-webhook-events) or [Get Webhook Event](/api-reference/webhooks/get-webhook-event) endpoints)

<Warning>
We only keep a trace of Webhook Events in our system for a **retention period of 31 days**. Past that, they are discarded, so you cannot see them using [List Webhook Events](/api-reference/webhooks/list-webhook-events) or [Get Webhook Event](/api-reference/webhooks/get-webhook-event) endpoints.
</Warning>

Here's an example of a Webhook Event of kind "`wallet.transfer.requested`" delivered to your webhook:

```json
{
  "id": "wh-xxx-xxxxxxx",
  "kind": "wallet.transfer.requested",
  "date": "2023-12-04T10:02:22.280Z",
  "data": {
    "transferRequest": {
      "id": "xfr-1vs8g-c1ub1-xxxxxxxxxxxxxxxx",
      "walletId": "wa-39abb-e9kpk-xxxxxxxxxxxxxxxx",
      "network": "EthereumSepolia",
      "requester": {
        "userId": "us-3v1ag-v6b36-xxxxxxxxxxxxxxxx",
        "tokenId": "to-7mkkj-c831n-xxxxxxxxxxxxxxxx",
       },
      "requestBody": {
        "kind": "Native",
        "to": "0xb282dc7cde21717f18337a596e91ded00b79b25f",
        "amount": "1000000000"
      },
      "dateRequested": "2023-05-08T19:14:25.568Z",
      "status": "Pending"
    }
  },
  "status": "200",
  "timestampSent": 1701684144,
}
```

## Supported Webhook Events

The list below shows which event kinds webhooks can subscribe to ⬇️ (see [Webhook Event Data](#webhook-event-data) section for details on each event kind)

<table><thead><tr><th width="357">Event Enum</th><th>Description</th></tr></thead><tbody><tr><td><code>wallet.blockchainevent.detected</code></td><td>A wallet event has been detected on chain (eg. a deposit). Note: This is only available for <a href="https://docs.dfns.co/d/api-docs/wallets#tier-1-vs-tier-2-support">Tier-1 chains</a>.</td></tr><tr><td><code>wallet.created</code></td><td>A wallet has been <a href="/api-reference/wallets/create-wallet">created</a>.</td></tr><tr><td><code>wallet.exported</code></td><td>A wallet has been <a href="/api-reference/wallets/export-wallet">exported</a>.</td></tr><tr><td><code>wallet.delegated</code></td><td>A wallet has been <a href="/api-reference/wallets/delegate-wallet">delegated</a>.</td></tr><tr><td><code>wallet.signature.requested</code></td><td>A <a href="https://docs.dfns.co/d/api-docs/wallets/generate-signature-from-wallet">generate signature</a> request has been created.</td></tr><tr><td><code>wallet.signature.failed</code></td><td>A <a href="https://docs.dfns.co/d/api-docs/wallets/generate-signature-from-wallet">generate signature</a> request has failed to process.</td></tr><tr><td><code>wallet.signature.rejected</code></td><td>A <a href="https://docs.dfns.co/d/api-docs/wallets/generate-signature-from-wallet">generate signature</a> request with a policy approval has been rejected.</td></tr><tr><td><code>wallet.signature.signed</code></td><td>A <a href="https://docs.dfns.co/d/api-docs/wallets/generate-signature-from-wallet">generate signature</a> request has completed.</td></tr><tr><td><code>wallet.transaction.requested</code></td><td>A <a href="/api-reference/wallets/sign-and-broadcast-transaction">broadcast transaction</a> request has been created.</td></tr><tr><td><code>wallet.transaction.failed</code></td><td>A <a href="/api-reference/wallets/sign-and-broadcast-transaction">broadcast transaction</a> request has failed to process.</td></tr><tr><td><code>wallet.transaction.rejected</code></td><td>A <a href="/api-reference/wallets/sign-and-broadcast-transaction">broadcast transaction</a> request with a policy approval has been rejected.</td></tr><tr><td><code>wallet.transaction.broadcasted</code></td><td>A <a href="/api-reference/wallets/sign-and-broadcast-transaction">broadcast transaction</a> request has been submitted to the mempool.</td></tr><tr><td><code>wallet.transaction.confirmed</code></td><td>A <a href="/api-reference/wallets/sign-and-broadcast-transaction">broadcast transaction</a> request has been confirmed on chain. Note: This is only available for <a href="https://docs.dfns.co/d/api-docs/wallets#tier-1-vs-tier-2-support">Tier-1 chains</a>.</td></tr><tr><td><code>wallet.transfer.requested</code></td><td>A <a href="/api-reference/wallets/transfer-asset">wallet transfer</a> request has been created.</td></tr><tr><td><code>wallet.transfer.failed</code></td><td>A <a href="/api-reference/wallets/transfer-asset">wallet transfer</a> request has failed to process.</td></tr><tr><td><code>wallet.transfer.rejected</code></td><td>A <a href="/api-reference/wallets/transfer-asset">wallet transfer</a> request with a policy approval has been rejected.</td></tr><tr><td><code>wallet.transfer.broadcasted</code></td><td>A <a href="/api-reference/wallets/transfer-asset">wallet transfer</a> request has been submitted to the mempool.</td></tr><tr><td><code>wallet.transfer.confirmed</code></td><td>A <a href="/api-reference/wallets/transfer-asset">wallet transfer</a> request has been confirmed on chain. Note: This is only available for <a href="https://docs.dfns.co/d/api-docs/wallets#tier-1-vs-tier-2-support">Tier-1 chains</a>.</td></tr><tr><td><code>policy.triggered</code></td><td>A policy got triggered upon some activity (the policy rule got evaluated, and it triggered)</td></tr><tr><td><code>policy.approval.pending</code></td><td>A new<a href="/core-concepts/policies#approval"> Approval</a> process has been created and is pending.</td></tr><tr><td><code>policy.approval.resolved</code></td><td>A new<a href="/core-concepts/policies#approval"> Approval</a> process is finalized: it's either approved or rejected.</td></tr></tbody></table>

## Webhook Event Data

Each webhook event has a "`data`" property, which shape depends on its kind. Here's an overview of the shape of the data for each kind:

* For `wallet.created`, `wallet.exported`, `wallet.delegated` see the [Get Wallet response](/api-reference/wallets/get-wallet):

```json data
{ // Wallet object, as in "Create Wallet" endpoint response
  "wallet": {      
    "id": "wa-xxx-xxxxxxxxx",
    ...
  }
}
```


* For `wallet.transfer.requested`, `wallet.transfer.failed`, `wallet.transfer.rejected`, `wallet.transfer.broadcasted`, `wallet.transfer.confirmed` see the [Get Transfer response](/api-reference/wallets/get-transfer):

```json data
{ // Wallet Transfer Request object as in "Wallet Send Transfer" endpoint
  "transferRequest": {
    "id": "xfr-xxx-xxxxxxxxx",
    "walletId": "wa-xxx-xxxxxxxx",
    ...
  }
}
```


* For `wallet.transaction.requested`, `wallet.transaction.failed`, `wallet.transaction.rejected`, `wallet.transaction.broadcasted`, `wallet.transaction.confirmed` see the [Get Transaction response](/api-reference/wallets/get-transaction) :

```json data
{ // Wallet Transaction Request as in "Wallet Broadcast Transaction" endpoint
  "transactionRequest": {
    "id": "tx-xxx-xxxxxxxxx",
    "walletId": "wa-xxx-xxxxxxxx",
    ...
  }
}
```


* For `wallet.signature.requested`, `wallet.signature.failed`, `wallet.signature.rejected`, `wallet.signature.signed` see the [Get Signature response](/api-reference/wallets/generate-signature):

```json data
{ // Wallet Signature Request object as in "Wallet Generate Signature" endpoint
  "signatureRequest": {
    "id": "sig-xxx-xxxxxxxxx",
    "walletId": "wa-xxx-xxxxxxxx",
    ...
  }
}
```


* For `wallet.blockchainevent.detected` various event kinds are available depending on the indexed chain:\\

| Kind                                         | Chains                             |
| -------------------------------------------- | ---------------------------------- |
| NativeTransfer                               | All                                |
| Aip21Transfer                                | Aptos                              |
| AsaTransfer                                  | Algorand                           |
| CoinTransfer, LockedCoinTransfer             | Iota                               |
| Erc20Transfer, Erc721Transfer                | Evm                                |
| Tep74Transfer                                | Ton                                |
| Trc10Transfer, Trc20Transfer, Trc721Transfer | Tron                               |
| Sep41Transfer                                | Stellar                            |
| SplTransfer, Spl2022Transfer                 | Solana                             |
| UtxoTransfer                                 | Bitcoin, Litecoin, Dogecoin, Kaspa |

for example, see the [Get History response](/api-reference/wallets/get-wallet-history):

```json data
{ // Blockchain Event object as in "Wallet Get Wallet History" endpoint
  "blockchainEvent": {
    "kind": "Erc20Transfer",
    "contract": "0x......",
    "from": "0x......",
    "to": "0x......",
    "direction": "In",
    ...
  }
}
```


* For `policy.triggered`

```json data
{
  "policyEvaluation": {
    "id": "plce-xxxxxxx",
    "triggered": true,
    "reason": "Transfer amount (USD 10000) is above limit (USD 5000). ",
    "date": "2024-06-28T09:09:54.437Z",

    "policy": { // policy object as in "Get Policy" endpoint
      "id": "plc-xxxxxxx",
      "name": "Accounting wallet transfer limit",
      ...,
    },

    "activity": {
      "kind": "Wallets:Sign"
      "transferRequest": { // transfer request object as in "Get Transfer" endpoint
        "id": "xfr-xxxxxxx",
        ...
      }
    },

    "context": { // its content depends on the kind of the policy rule
      "transactionAmount": {
        "value": "10000,
        "currency": "USD",
      },
    },
  }
}
```


* For `policy.approval.pending` and `policy.approval.resolved`, see the [List Approvals response](/api-reference/policies/get-approval):

```json data
{ // Approval object
  "approval": {      
    "activityId": "cr-2100g-xxxxxxxxx",
    ...
  }
}
```


## Webhook Event Ordering <a href="#best-practices" id="best-practices"></a>

Dfns doesn’t guarantee delivery of events in the order in which they’re generated. For example, when a wallet [Transfer](/api-reference/wallets/transfer-asset) is picked up on-chain by our blockchain indexers, we might generate the following events:

* `wallet.transfer.confirmed` - this event notifies you that the [Transfer Request](/api-reference/wallets/transfer-asset) that you made has been confirmed on chain
* `wallet.blockchainevent.detected`- this event notifies you of the new Blockchain Event detected and added to your [Wallet History](/api-reference/wallets/get-wallet-history) blockchain events

Your endpoint shouldn’t expect delivery of these events in this order, and needs to handle delivery accordingly.

## Webhook Event Deliveries & Retries

During an webhook event delivery attempt, if we cannot reach your webhook endpoint, or if your endpoint **returns anything else than a 200** status code in the response, we consider the delivery of this event has failed.

In such a case, Dfns is going to retry delivering it to your webhook, up to 5 total attempts over 24 hours, with an exponential backoff (delays from first attempt: 1m, 12min, 2h, 1d).

Every event delivery attempt will create a new Webhook Event, with its own unique ID, containing the same `data` than the previous event which failed delivering. So in the [List Webhook Events](/api-reference/webhooks/list-webhook-events) endpoint, every Webhook Event you will see is a unique delivery attempt (potentially of the same original event).

The event that your webhook handler will receive (in your server), will include the attempt number in the payload (`deliveryAttempt: 1` for the first attempt). Also, if it includes the field `retryOf: "whe-xxxxxxx"` , it indicates that this event you are receiving, is a "retry of" a previous Webhook Event which failed delivering.

Additionally, if you fetch Webhook Events we tried delivering, using the [List Webhook Events](/api-reference/webhooks/list-webhook-events) or [Get Webhook ](/api-reference/webhooks/get-webhook-event), you will be able to see the `deliveryFailed` boolean field indicating if delivery succeeded or not, as well as the `nextAttemptDate: "2024-01-24-xxxxxx"` date showing you around which time the next delivery attempt to your webhook will occur (if delivery failed).

If you want to fetch all Webhook Events which failed delivering to your webhook, you can use the [List Webhook Events](/api-reference/webhooks/list-webhook-events) with the query parameter `deliveryFailed=true`. And amongst all those returned, you can see those which failed delivering, and will not retry in future (because reached maximum retry attempt), by filtering those which have no `nextAttemptDate` .

If your webhook has been disabled or deleted when Dfns attempts a retry, future retries of that event are prevented. However, if you disable and then re-enable a webhook endpoint before Dfns can retry, you can still expect to see future retry attempts.
